directory
=========

Stores contextual information for the data. This includes the entities, entity_types, data_sources, etc. It is the entrypoint when looking for data.

Tables
------

alias
`````



+-----------+-------------------+---------------+
| Name      | Type              |   Description |
+===========+===================+===============+
| entity_id | integer           |               |
+-----------+-------------------+---------------+
| name      | character varying |               |
+-----------+-------------------+---------------+
| type_id   | integer           |               |
+-----------+-------------------+---------------+


alias_type
``````````



+--------+-------------------+---------------+
| Name   | Type              |   Description |
+========+===================+===============+
| id     | integer           |               |
+--------+-------------------+---------------+
| name   | character varying |               |
+--------+-------------------+---------------+


data_source
```````````

Describes data_sources. A data_source is used to indicate where data came from. Datasources are also used to prevent collisions between sets of data from different sources, where names can be the same, but the meaning of the data differs.

+-------------+------------------------+---------------+
| Name        | Type                   |   Description |
+=============+========================+===============+
| id          | integer                |               |
+-------------+------------------------+---------------+
| name        | character varying(100) |               |
+-------------+------------------------+---------------+
| description | character varying      |               |
+-------------+------------------------+---------------+


entity
``````

Describes entities. An entity is the base object for which the database can hold further information such as attributes, trends and notifications. All data must have a reference to an entity.

+----------------+--------------------------+---------------+
| Name           | Type                     |   Description |
+================+==========================+===============+
| id             | integer                  |               |
+----------------+--------------------------+---------------+
| created        | timestamp with time zone |               |
+----------------+--------------------------+---------------+
| name           | character varying        |               |
+----------------+--------------------------+---------------+
| entity_type_id | integer                  |               |
+----------------+--------------------------+---------------+
| dn             | character varying        |               |
+----------------+--------------------------+---------------+
| parent_id      | integer                  |               |
+----------------+--------------------------+---------------+


entity_tag_link
```````````````



+-----------+---------+---------------+
| Name      | Type    |   Description |
+===========+=========+===============+
| tag_id    | integer |               |
+-----------+---------+---------------+
| entity_id | integer |               |
+-----------+---------+---------------+


entity_tag_link_denorm
``````````````````````



+-----------+---------+---------------+
| Name      | Type    |   Description |
+===========+=========+===============+
| entity_id | integer |               |
+-----------+---------+---------------+
| tags      | text[]  |               |
+-----------+---------+---------------+
| name      | text    |               |
+-----------+---------+---------------+


entity_type
```````````

Stores the entity types that exist in the entity table. Entity types are also used to give context to data that is stored for entities.

+-------------+-----------------------+---------------+
| Name        | Type                  |   Description |
+=============+=======================+===============+
| id          | integer               |               |
+-------------+-----------------------+---------------+
| name        | character varying(50) |               |
+-------------+-----------------------+---------------+
| description | character varying     |               |
+-------------+-----------------------+---------------+


existence
`````````



+----------------+--------------------------+---------------+
| Name           | Type                     |   Description |
+================+==========================+===============+
| timestamp      | timestamp with time zone |               |
+----------------+--------------------------+---------------+
| exists         | boolean                  |               |
+----------------+--------------------------+---------------+
| entity_id      | integer                  |               |
+----------------+--------------------------+---------------+
| entity_type_id | integer                  |               |
+----------------+--------------------------+---------------+


existence_staging
`````````````````



+--------+-------------------+---------------+
| Name   | Type              |   Description |
+========+===================+===============+
| dn     | character varying |               |
+--------+-------------------+---------------+


tag
```

Stores all tags. A tag is a simple label that can be attached to a number of object types in the database, such as entities and trends.

+--------------+-------------------+---------------+
| Name         | Type              |   Description |
+==============+===================+===============+
| id           | integer           |               |
+--------------+-------------------+---------------+
| name         | character varying |               |
+--------------+-------------------+---------------+
| tag_group_id | integer           |               |
+--------------+-------------------+---------------+
| description  | character varying |               |
+--------------+-------------------+---------------+


tag_group
`````````



+---------------+-------------------+---------------+
| Name          | Type              |   Description |
+===============+===================+===============+
| id            | integer           |               |
+---------------+-------------------+---------------+
| name          | character varying |               |
+---------------+-------------------+---------------+
| complementary | boolean           |               |
+---------------+-------------------+---------------+

Functions
---------

+------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------+
| Name                                                                                                 | Return Type                                                     |   Description |
+======================================================================================================+=================================================================+===============+
| array_to_dn_part(character varying[])                                                                | directory.dn_part                                               |               |
+------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------+
| compile_minerva_query(query text)                                                                    | text                                                            |               |
+------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------+
| compile_minerva_query(query directory.query_part[])                                                  | text                                                            |               |
+------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------+
| create alias for new entity (func)()                                                                 | trigger                                                         |               |
+------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------+
| create entity_tag_link for new entity (func)()                                                       | trigger                                                         |               |
+------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------+
| create tag for new entity_types (func)()                                                             | trigger                                                         |               |
+------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------+
| create_data_source(character varying)                                                                | directory.data_source                                           |               |
+------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------+
| create_entity_from_dn(character varying)                                                             | directory.entity                                                |               |
+------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------+
| create_entity_type(character varying)                                                                | directory.entity_type                                           |               |
+------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------+
| dn_part_to_string(directory.dn_part)                                                                 | character varying                                               |               |
+------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------+
| dn_to_entity(character varying)                                                                      | directory.entity                                                |               |
+------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------+
| dns_to_entity_ids(character varying[])                                                               | SETOF integer                                                   |               |
+------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------+
| entity_id(directory.entity)                                                                          | integer                                                         |               |
+------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------+
| entity_type_id(directory.entity_type)                                                                | integer                                                         |               |
+------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------+
| existence_at(timestamp with time zone)                                                               | SETOF directory.existence                                       |               |
+------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------+
| existence_staging_state(timestamp with time zone)                                                    | SETOF directory.existence                                       |               |
+------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------+
| existing_staging(timestamp with time zone)                                                           | SETOF directory.existence                                       |               |
+------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------+
| explode_dn(character varying)                                                                        | directory.dn_part[]                                             |               |
+------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------+
| get_alias(entity_id integer, alias_type_name character varying)                                      | character varying                                               |               |
+------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------+
| get_data_source(character varying)                                                                   | directory.data_source                                           |               |
+------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------+
| get_entity_by_dn(character varying)                                                                  | directory.entity                                                |               |
+------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------+
| get_entity_by_id(integer)                                                                            | directory.entity                                                |               |
+------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------+
| get_entity_type(character varying)                                                                   | directory.entity_type                                           |               |
+------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------+
| get_existence(timestamp with time zone, integer)                                                     | boolean                                                         |               |
+------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------+
| glue_dn(directory.dn_part[])                                                                         | character varying                                               |               |
+------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------+
| last_dn_part(directory.dn_part[])                                                                    | directory.dn_part                                               |               |
+------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------+
| make_c_join(index integer, entity_id_table text, entity_id_column text, tag_index integer, tag text) | text                                                            |               |
+------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------+
| make_s_join(index integer, entity_id_table text, entity_id_column text, alias text)                  | text                                                            |               |
+------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------+
| name_to_data_source(character varying)                                                               | directory.data_source                                           |               |
+------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------+
| name_to_entity_type(character varying)                                                               | directory.entity_type                                           |               |
+------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------+
| new_existence_state(timestamp with time zone)                                                        | SETOF directory.existence                                       |               |
+------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------+
| non_existing_staging(timestamp with time zone)                                                       | SETOF directory.existence                                       |               |
+------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------+
| parent_dn(character varying)                                                                         | character varying                                               |               |
+------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------+
| parent_dn_parts(directory.dn_part[])                                                                 | directory.dn_part[]                                             |               |
+------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------+
| run_minerva_query(query directory.query_part[])                                                      | TABLE(id integer, dn character varying, entity_type_id integer) |               |
+------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------+
| split_raw_part(character varying)                                                                    | directory.dn_part                                               |               |
+------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------+
| tag_entity(dn character varying, tag character varying)                                              | character varying                                               |               |
+------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------+
| tag_entity(entity_id integer, tag character varying)                                                 | integer                                                         |               |
+------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------+
| transfer_existence(timestamp with time zone)                                                         | timestamp with time zone                                        |               |
+------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------+
| update_denormalized_entity_tags(entity_id integer)                                                   | directory.entity_tag_link_denorm                                |               |
+------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------+
| update_entity_tag_link_denorm_for_delete()                                                           | trigger                                                         |               |
+------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------+
| update_entity_tag_link_denorm_for_insert()                                                           | trigger                                                         |               |
+------------------------------------------------------------------------------------------------------+-----------------------------------------------------------------+---------------+
