system
======



Tables
------

job_error_log
`````````````



+---------+-------------------+-------------+
|  Name   |       Type        | Description |
+=========+===================+=============+
| job_id  | integer           | None        |
+---------+-------------------+-------------+
| message | character varying | None        |
+---------+-------------------+-------------+


setting
```````



+-------+---------+-------------+
| Name  |  Type   | Description |
+=======+=========+=============+
| id    | integer | None        |
+-------+---------+-------------+
| name  | text    | None        |
+-------+---------+-------------+
| value | text    | None        |
+-------+---------+-------------+


job
```



+---------------+--------------------------+-------------+
|     Name      |           Type           | Description |
+===============+==========================+=============+
| id            | integer                  | None        |
+---------------+--------------------------+-------------+
| type          | character varying        | None        |
+---------------+--------------------------+-------------+
| description   | character varying        | None        |
+---------------+--------------------------+-------------+
| size          | bigint                   | None        |
+---------------+--------------------------+-------------+
| created       | timestamp with time zone | None        |
+---------------+--------------------------+-------------+
| started       | timestamp with time zone | None        |
+---------------+--------------------------+-------------+
| finished      | timestamp with time zone | None        |
+---------------+--------------------------+-------------+
| job_source_id | integer                  | None        |
+---------------+--------------------------+-------------+
| state         | system.job_state_enum    | None        |
+---------------+--------------------------+-------------+


job_source
``````````



+----------+-----------------------+-------------+
|   Name   |         Type          | Description |
+==========+=======================+=============+
| id       | integer               | None        |
+----------+-----------------------+-------------+
| name     | character varying(64) | None        |
+----------+-----------------------+-------------+
| job_type | character varying(64) | None        |
+----------+-----------------------+-------------+
| config   | character varying     | None        |
+----------+-----------------------+-------------+


job_queue
`````````



+--------+---------+-------------+
|  Name  |  Type   | Description |
+========+=========+=============+
| job_id | integer | None        |
+--------+---------+-------------+

Functions
---------
+-------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------+-------------+
|                                                 Name                                                  |                                     Return Type                                     | Description |
+=======================================================================================================+=====================================================================================+=============+
| add_job_source(character varying, character varying, character varying)                               | integer                                                                             |             |
+-------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------+-------------+
| add_setting(name text, value text)                                                                    | system.setting                                                                      |             |
+-------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------+-------------+
| create_job(type character varying, description character varying, size bigint, job_source_id integer) | integer                                                                             |             |
+-------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------+-------------+
| fail_job(job_id integer, message character varying)                                                   | void                                                                                |             |
+-------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------+-------------+
| fail_job(job_id integer)                                                                              | void                                                                                |             |
+-------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------+-------------+
| finish_job(job_id integer)                                                                            | void                                                                                |             |
+-------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------+-------------+
| get_job()                                                                                             | system.job_type                                                                     |             |
+-------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------+-------------+
| get_job_source(integer)                                                                               | TABLE(name character varying, job_type character varying, config character varying) |             |
+-------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------+-------------+
| get_setting(name text)                                                                                | system.setting                                                                      |             |
+-------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------+-------------+
| get_setting_value(name text, "default" text)                                                          | text                                                                                |             |
+-------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------+-------------+
| get_setting_value(name text)                                                                          | text                                                                                |             |
+-------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------+-------------+
| remove_jobs(before timestamp with time zone)                                                          | integer                                                                             |             |
+-------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------+-------------+
| set_setting(name text, value text)                                                                    | system.setting                                                                      |             |
+-------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------+-------------+
| update_setting(name text, value text)                                                                 | system.setting                                                                      |             |
+-------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------+-------------+
